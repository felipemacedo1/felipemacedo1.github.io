<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teste dos Componentes Modulares - Contribution Widgets</title>
  <style>
    body { 
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif; 
      padding: 20px; 
      max-width: 1200px; 
      margin: 0 auto; 
      background: #0d1117; 
      color: #e6edf3; 
      line-height: 1.5;
    }
    
    h1, h2 { color: #f0f6fc; }
    
    .test-section {
      margin-bottom: 40px;
      padding: 20px;
      border: 1px solid #30363d;
      border-radius: 8px;
      background: #161b22;
    }
    
    .test-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    
    .test-container {
      border: 1px solid #21262d;
      border-radius: 6px;
      padding: 16px;
      background: #0d1117;
    }
    
    .component-label {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #58a6ff;
    }
    
    @media (max-width: 768px) {
      .test-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100px;
      color: #7d8590;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>üß™ Teste dos Componentes Modulares</h1>
  <p>Esta p√°gina testa os novos componentes modulares de contribui√ß√µes.</p>

  <!-- Teste do ModularContributionWidget completo -->
  <div class="test-section">
    <h2>ModularContributionWidget (Completo)</h2>
    <div class="test-container">
      <div class="component-label">Widget Modular Completo - Tema GitHub</div>
      <div id="modular-widget-full" class="loading">Carregando widget completo...</div>
    </div>
  </div>

  <!-- Teste dos componentes individuais -->
  <div class="test-section">
    <h2>Componentes Individuais</h2>
    
    <div class="test-grid">
      <div class="test-container">
        <div class="component-label">ContributionStatsCard (Completo)</div>
        <div id="stats-full" class="loading">Carregando estat√≠sticas...</div>
      </div>
      
      <div class="test-container">
        <div class="component-label">ContributionStatsCard (Compacto)</div>
        <div id="stats-compact" class="loading">Carregando estat√≠sticas compactas...</div>
      </div>
      
      <div class="test-container">
        <div class="component-label">ContributionGridRenderer (Normal)</div>
        <div id="grid-normal" class="loading">Carregando grid...</div>
      </div>
      
      <div class="test-container">
        <div class="component-label">ContributionControls</div>
        <div id="controls" class="loading">Carregando controles...</div>
      </div>
    </div>
  </div>

  <!-- Teste de diferentes temas -->
  <div class="test-section">
    <h2>Diferentes Temas</h2>
    
    <div class="test-grid">
      <div class="test-container">
        <div class="component-label">Tema Terminal</div>
        <div id="terminal-theme" class="loading">Carregando tema terminal...</div>
      </div>
      
      <div class="test-container">
        <div class="component-label">Tema BIOS</div>
        <div id="bios-theme" class="loading">Carregando tema BIOS...</div>
      </div>
    </div>
  </div>

  <!-- Teste do UnifiedContributionWidget (compatibilidade) -->
  <div class="test-section">
    <h2>UnifiedContributionWidget (Compatibilidade)</h2>
    <div class="test-container">
      <div class="component-label">Widget Unificado (usando novos componentes internamente)</div>
      <div id="unified-widget" class="loading">Carregando widget unificado...</div>
    </div>
  </div>

  <script type="module">
    // Fun√ß√£o para carregar dados de teste
    async function loadTestData() {
      try {
        const response = await fetch('../../analytics/activity-rolling-365d-felipemacedo1.json');
        if (!response.ok) throw new Error('Dados n√£o encontrados');
        return await response.json();
      } catch (error) {
        console.error('Erro ao carregar dados de teste:', error);
        // Dados de exemplo para fallback
        const testData = { daily_metrics: {} };
        const today = new Date();
        
        // Gerar dados de exemplo para os √∫ltimos 365 dias
        for (let i = 0; i < 365; i++) {
          const date = new Date(today);
          date.setDate(today.getDate() - i);
          const dateStr = date.toISOString().split('T')[0];
          testData.daily_metrics[dateStr] = Math.floor(Math.random() * 15);
        }
        
        return testData;
      }
    }

    // Teste do ModularContributionWidget completo
    async function testModularWidget() {
      try {
        const { default: ModularContributionWidget } = await import('../../src/js/widgets/ModularContributionWidget.js');
        const container = document.getElementById('modular-widget-full');
        
        const widget = new ModularContributionWidget(container, {
          author: 'felipemacedo1',
          period: 'rolling',
          theme: 'github',
          size: 'normal',
          showStats: true,
          showControls: true,
          showTooltips: true,
          showLegend: true
        });
        
        await widget.init();
        console.log('‚úÖ ModularContributionWidget carregado com sucesso');
      } catch (error) {
        console.error('‚ùå Erro no ModularContributionWidget:', error);
        document.getElementById('modular-widget-full').innerHTML = `<div style="color: #f85149;">Erro: ${error.message}</div>`;
      }
    }

    // Teste dos componentes individuais
    async function testIndividualComponents() {
      try {
        const data = await loadTestData();
        const dailyMetrics = data.daily_metrics;

        // Teste ContributionStatsCard (completo)
        const { default: ContributionStatsCard } = await import('../../src/js/widgets/components/ContributionStatsCard.js');
        const statsFullContainer = document.getElementById('stats-full');
        const statsCardFull = new ContributionStatsCard(statsFullContainer, {
          theme: 'github',
          compact: false,
          showTrend: true
        });
        statsCardFull.render(dailyMetrics);

        // Teste ContributionStatsCard (compacto)
        const statsCompactContainer = document.getElementById('stats-compact');
        const statsCardCompact = new ContributionStatsCard(statsCompactContainer, {
          theme: 'github',
          compact: true,
          showTrend: false
        });
        statsCardCompact.render(dailyMetrics);

        // Teste ContributionGridRenderer
        const { default: ContributionGridRenderer } = await import('../../src/js/widgets/components/ContributionGridRenderer.js');
        const gridContainer = document.getElementById('grid-normal');
        const gridRenderer = new ContributionGridRenderer(gridContainer, {
          theme: 'github',
          size: 'normal',
          showTooltips: true,
          showLegend: true
        });
        gridRenderer.render(dailyMetrics);

        // Teste ContributionControls
        const { default: ContributionControls } = await import('../../src/js/widgets/components/ContributionControls.js');
        const controlsContainer = document.getElementById('controls');
        const controls = new ContributionControls(controlsContainer, {
          theme: 'github',
          period: 'rolling',
          compact: false
        });
        controls.render();

        // Configurar callbacks de exemplo
        controls.on('onPeriodChange', (period) => {
          console.log('Per√≠odo alterado:', period);
        });

        controls.on('onThemeChange', (theme) => {
          console.log('Tema alterado:', theme);
        });

        controls.on('onExport', () => {
          console.log('Exporta√ß√£o solicitada');
          alert('Funcionalidade de exporta√ß√£o ativada!');
        });

        console.log('‚úÖ Componentes individuais carregados com sucesso');
      } catch (error) {
        console.error('‚ùå Erro nos componentes individuais:', error);
      }
    }

    // Teste de diferentes temas
    async function testThemes() {
      try {
        const data = await loadTestData();
        const dailyMetrics = data.daily_metrics;
        const { default: ModularContributionWidget } = await import('../../src/js/widgets/ModularContributionWidget.js');

        // Tema Terminal
        const terminalContainer = document.getElementById('terminal-theme');
        const terminalWidget = new ModularContributionWidget(terminalContainer, {
          theme: 'terminal',
          size: 'compact',
          showStats: true,
          showControls: false,
          showLegend: true
        });
        await terminalWidget.init();

        // Tema BIOS
        const biosContainer = document.getElementById('bios-theme');
        const biosWidget = new ModularContributionWidget(biosContainer, {
          theme: 'bios',
          size: 'compact',
          showStats: true,
          showControls: false,
          showLegend: true
        });
        await biosWidget.init();

        console.log('‚úÖ Temas carregados com sucesso');
      } catch (error) {
        console.error('‚ùå Erro nos temas:', error);
      }
    }

    // Teste de compatibilidade com UnifiedContributionWidget
    async function testCompatibility() {
      try {
        const { default: UnifiedContributionWidget } = await import('../../src/js/widgets/UnifiedContributionWidget.js');
        const container = document.getElementById('unified-widget');
        
        const widget = new UnifiedContributionWidget(container, {
          author: 'felipemacedo1',
          period: 'rolling',
          size: 'compact',
          theme: 'github',
          mode: 'widget',
          showStats: true,
          showTooltips: true
        });
        
        await widget.init();
        console.log('‚úÖ UnifiedContributionWidget (compatibilidade) carregado com sucesso');
      } catch (error) {
        console.error('‚ùå Erro no teste de compatibilidade:', error);
        document.getElementById('unified-widget').innerHTML = `<div style="color: #f85149;">Erro: ${error.message}</div>`;
      }
    }

    // Executar todos os testes
    async function runAllTests() {
      console.log('üöÄ Iniciando testes dos componentes modulares...');
      
      await testModularWidget();
      await testIndividualComponents();
      await testThemes();
      await testCompatibility();
      
      console.log('üéâ Todos os testes executados!');
    }

    // Executar testes quando a p√°gina carregar
    runAllTests();
  </script>
</body>
</html>
